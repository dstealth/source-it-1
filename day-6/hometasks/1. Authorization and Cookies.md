# Authorization & Cookies

## Задача

1. Для задачи с импортом и отображением продуктов ([day-5](../day-5)) реализовать авторизацию.

* Страницы загрузки и просмотра товаров должны быть доступны только авторизованому пользователю. При попытке зайти на закрытые страницы пользователь должен быть перенаправлен на страницу авторизации. Пример:
```
<?php
if (!isLoggedIn()) {
    header('Location: login.php'); // Посылаем заголовок перенаправления.
    exit();
}
// ...
``` 

* В случае неудачной авторизации (неправильный пароль или не существующий пользователь) нужно показать соответствующее сообщение об ошибке.

* Список пользователей, которые могут авторизоваться, должен храниться в файле на сервере в следующем формате:
```
%email%:%password_hash%
```

Пример:
```
john@example.com:098f6bcd4621d373cade4e832627b4f6
denis@example.com:5a105e8b9d40e1329780d62ea2265d8a
...
```

* После авторизации на страницах загрузки просмотра товаров должно отображаться имя пользователя. В качестве имени можно взять первую часть электронной почты:
```
john@example.com -> John
denis@example.com -> Denis
```
Либо можно добавить имя в файл с пользователями.

* После авторизации возле имени пользователя должна быть кнопка "Log out" (или "Выйти").
При нажатии на нее авторизация должна сброситься, а пользователь должен попасть на страницу с формой авторизации.

* Форма авторизации должна быть недоступна для авторизованого пользователя.

2. На странице просмотренных продуктов последняя используемая сортировка должна сохраняться в Cookies пользователя. При повтороном открытии страницы без параметров сортировки (в URL) должно использоваться значение, взятое из Cookies.

## Материалы

* [session_start()](http://ua2.php.net/manual/en/function.session-start.php)
* [session_destroy()](http://ua2.php.net/manual/en/function.session-destroy.php)
* [session_id()](http://ua2.php.net/manual/en/function.session-id.php)
* [$_SESSION](http://ua2.php.net/manual/en/reserved.variables.session.php)
* [setcookie()](http://ua2.php.net/manual/en/function.setcookie.php)
* [$_COOKIE](http://ua2.php.net/manual/en/reserved.variables.cookies.php)
* [header()](http://ua2.php.net/manual/en/function.header.php)